From d52fc5c03904a34df6f8695d4e9d674e5d443aab Mon Sep 17 00:00:00 2001
From: Regina Obe <lr@pcorp.us>
Date: Thu, 11 Feb 2021 15:43:52 -0500
Subject: [PATCH 62/88] Revise subdivide test so both geos 3.9 and geos 3.10
 agree on same answer.  References #4837 for PostGIS 3.2

---
 regress/core/fixedoverlay.sql      | 7 +++++--
 regress/core/fixedoverlay_expected | 5 +----
 2 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/regress/core/fixedoverlay.sql b/regress/core/fixedoverlay.sql
index facaaab90..0953d3e44 100644
--- a/regress/core/fixedoverlay.sql
+++ b/regress/core/fixedoverlay.sql
@@ -22,6 +22,9 @@ SELECT 'unaryunion', ST_AsText(ST_UnaryUnion(
 	'GEOMETRYCOLLECTION(LINESTRING(0.5 0, 9 0), LINESTRING(7 0, 13.2 0))'::geometry,
 2));
 
-SELECT 'subdivide', ST_AsText(ST_Subdivide(
+WITH n AS (SELECT geom
+FROM ST_Subdivide(
 	'POLYGON((0 0,0 10,10 10,10 6,100 5.1, 100 10, 110 10, 110 0, 100 0,100 4.9,10 5,10 0,0 0))'::geometry,
-5, 2));
+6, 1) AS geom)
+SELECT 'subdivide', count(geom), ST_AsText(ST_Normalize(ST_Union(geom)))
+FROM n;
diff --git a/regress/core/fixedoverlay_expected b/regress/core/fixedoverlay_expected
index fb5a60604..6f2eb7639 100644
--- a/regress/core/fixedoverlay_expected
+++ b/regress/core/fixedoverlay_expected
@@ -3,7 +3,4 @@ difference|LINESTRING(0 0,8 0)
 symdifference|LINESTRING(0 0,8 0)
 union|MULTILINESTRING((0 0,8 0),(8 0,10 0),(10 0,14 0))
 unaryunion|MULTILINESTRING((0 0,8 0),(8 0,10 0),(10 0,14 0))
-subdivide|POLYGON((0 10,10 10,10 0,0 0,0 10))
-subdivide|POLYGON((10 6,100 6,100 4,10 6))
-subdivide|POLYGON((100 4,110 4,110 0,100 0,100 4))
-subdivide|POLYGON((100 10,110 10,110 4,100 4,100 10))
+subdivide|3|MULTIPOLYGON(((0 0,0 10,10 10,10 6,100 5,10 5,10 0,0 0)),((100 0,100 5,100 10,110 10,110 0,100 0)))
-- 
2.25.1

